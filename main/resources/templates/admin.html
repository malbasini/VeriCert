<!DOCTYPE html>
<html lang="it"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      th:fragment="layout(pageTitle, active, actionsFrag, contentFrag)">

<head>
    <meta charset="UTF-8">
    <title th:text="${pageTitle}">Admin</title>

    <!-- Bootstrap CSS + Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          rel="stylesheet">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
</head>

<body class="bg-light">
<!-- Inclusione dell'header -->
<div th:replace="base :: headerFragment"></div>
<header class="navbar navbar-expand-lg navbar-dark bg-dark px-3">
</header>
<div class="container-fluid">
    <div class="row">
        <!-- SIDEBAR -->
        <aside class="col-12 col-md-3 col-lg-2 bg-white border-end min-vh-100 py-3">
            <div class="list-group list-group-flush">

                <a th:href="@{/admin}"
                   class="list-group-item list-group-item-action d-flex align-items-center"
                   th:classappend="${active}=='dashboard' ? 'active'">
                    <i class="bi bi-speedometer2 me-2"></i>
                    Dashboard
                </a>

                <a th:href="@{/admin/templates}"
                   class="list-group-item list-group-item-action d-flex align-items-center"
                   th:classappend="${active}=='templates' ? 'active'">
                    <i class="bi bi-layout-text-window-reverse me-2"></i>
                    Template
                </a>

                <a th:href="@{/admin/certificates}"
                   class="list-group-item list-group-item-action d-flex align-items-center"
                   th:classappend="${active}=='certificates' ? 'active'">
                    <i class="bi bi-award me-2"></i>
                    Certificati
                </a>

                <a th:href="@{/admin/users}"
                   class="list-group-item list-group-item-action d-flex align-items-center"
                   th:classappend="${active}=='users' ? 'active'">
                    <i class="bi bi-people me-2"></i>
                    Utenti & Ruoli
                </a>

                <a th:href="@{/admin/settings}"
                   class="list-group-item list-group-item-action d-flex align-items-center"
                   th:classappend="${active}=='settings' ? 'active'">
                    <i class="bi bi-gear me-2"></i>
                    Impostazioni
                </a>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="col-12 col-md-9 col-lg-10 py-4">

            <!-- Header pagina con titolo e pulsanti azione -->
            <div class="d-flex flex-wrap justify-content-between align-items-start mb-4">
                <div>
                    <h1 class="h4 mb-1" th:text="${pageTitle}">Titolo pagina</h1>
                    <div class="text-muted small">
                        <span th:text="${currentTenant}">TenantName</span>
                        Â·
                        <span sec:authentication="name">utente</span>
                    </div>
                </div>

                <div th:replace="${actionsFrag}"> <!-- qui vanno i bottoni -->
                    <!-- fallback se non passato -->
                </div>
            </div>

            <!-- Contenuto principale -->
            <div th:replace="${contentFrag}">
                <!-- fallback se non passato -->
                <div class="alert alert-info">Nessun contenuto.</div>
            </div>

        </main>
    </div>
</div>

<!-- Toast container globale -->
<div class="position-fixed top-0 end-0 p-3" style="z-index: 1080">
    <div id="toastArea" class="toast align-items-center text-bg-danger border-0"
         role="alert" aria-live="assertive" aria-atomic="true" style="display:none;">
        <div class="d-flex">
            <div class="toast-body" id="toastMsg">Errore</div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto"
                    onclick="document.getElementById('toastArea').style.display='none'"></button>
        </div>
    </div>
</div>
<script>
    // helper toast globale
    function showToast(msg) {
        const toastEl = document.getElementById('toastArea');
        const bodyEl = document.getElementById('toastMsg');
        bodyEl.textContent = msg;
        toastEl.style.display = 'block';
        const bsToast = new bootstrap.Toast(toastEl);
        bsToast.show();
    }
</script>



<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
<!-- Inclusione dell'header -->
<div th:replace="footer :: footerFragment"></div>
</html>
